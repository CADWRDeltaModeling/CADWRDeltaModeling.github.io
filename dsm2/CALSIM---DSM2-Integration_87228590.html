<!DOCTYPE html>
<html>
    <head>
        <title>DSM2 version 8.2 : CALSIM - DSM2 Integration</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DSM2 version 8.2</a></span>
                            </li>
                                                    <li>
                                <span><a href="DSM2_87228545.html">DSM2</a></span>
                            </li>
                                                    <li>
                                <span><a href="Documentation_87228546.html">Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="Delta-DSM2-Documentation_87228587.html">Delta DSM2 Documentation</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DSM2 version 8.2 : CALSIM - DSM2 Integration
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Yu (Joey) Zhou</span> on Jan 27, 2021
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <h2 id="CALSIMDSM2Integration-Background">Background</h2><p>CALSIM is a water operations simulation model. It meets demands using reservoir release operations and other operational criteria. A crucial operational criteria is meeting the salinity and X2 standards in the Delta.</p><p>CALSIM relies on DSM2 simulation of water quality standards. However DSM2 is computationally expensive to run in repeated scenarios needed by CALSIM. CALSIM relies on a linear programming approach and needs flow salinity relationships to estimate the flow needed to meet a particular water quality standard. Furthermore CALSIM is a monthly model and needs to make assumptions pertaining to that limitation. </p><h2 id="CALSIMDSM2Integration-ArtificialNeuralNetworks(ANNs)">Artificial Neural Networks (ANNs)</h2><p>To make it computationally feasible, the flow salinity relationships are derived from DSM2 simulations with perturbations of inputs that are of concern to CALSIM. These flow relationship information is used as training data for Artificial Neural Networks (ANNs); more specifically Feed-forward Neural Networks (FNNs).  These ANNs then are surrogate models for DSM2 and are supposed to represent the impact of operations on X2 and salinity standards.</p><h2 id="CALSIMDSM2Integration-Fullcircleanalysis">Full circle analysis</h2><p>To verify the results derived from having a surrogate DSM2 (ANN) model in CALSIM, the CALSIM flows and gate conditions are converted into daily inputs (with assumptions for monthly to daily) for DSM2 and the output salinity is checked against the X2 or salinity standards in CALSIM. This is called a &quot;full circle analysis&quot;.  Typically  these have been done for a select period of 16 years but can be extended to the entire period of 82 years of simulation if desired.</p><h2 id="CALSIMDSM2Integration-DSM2boundaryconditions">DSM2 boundary conditions</h2><p>DSM2 needs flow and stage boundary conditions, i.e. the inputs at the edges of the domain that would drive the simulation.</p><ol><li>Flow boundaries: CALSIM operates the reservoirs upstream of the Delta and as a result the flow conditions are established by CALSIM simulations, though on a monthly time step resolution.</li><li>Gate positions:  CALSIM operates these to satisfy regulations and other constraints. </li><li>Stage boundary: The only one is the ocean boundary at Martinez that is derived from astronomical stage at San Francisco with regression using historical data to transfer to Martinez (Planning tide generator)</li><li>Martinez EC boundary: This is derived from a flow salinity relationship based on G model and stage boundaries (Planning Martinez EC generator)</li><li>Vernalis EC boundary. Derived from flow regression equations (Needs reference here)</li><li>Consumptive Use. These are represented in DSM2 at 258 nodes, CALSIM does not directly simulate these, however they are provided as input to CALSIM based on consumptive use models</li><li>Agricultural Drain EC. These are the most uncertain of the boundary conditions and are represented in DSM2 as annually repeating values.</li><li>Waste water treatment plants ??</li></ol><h2 id="CALSIMDSM2Integration-Implementation">Implementation</h2><p>These boundary conditions are explicitly mapped in this document between the CALSIM and DSM2 schematics. <a href="Schematics-and-Boundaries_87228608.html">Schematics and Boundaries</a></p><h2 id="CALSIMDSM2Integration-ResolvingMonthly-Dailyconversions">Resolving Monthly - Daily conversions</h2><p>CALSIM is a monthly time step model and DSM2 runs on 15 min or lower time steps. The input data for CALSIM is monthly averaged i.e. a single value for the entire month. DSM2 typically takes daily input values and is also capable of hourly or sub hourly resolved values.  This mismatch has to be resolved when doing this integration.</p><p>For daily to monthly conversions, it is simply a monthly averaging technique. For certain quantities, such as gate positions, a count of values may be computed ?</p><p>For monthly to daily conversions, there is huge impedance. This means a lot of information that is lost has to be either estimated or left as the same value repeated over the days of the month. This is usually the case for the flows, except that for stability reasons ( hydrodynamic models ) the transition days between months employ a volume conserving spline to smooth the transition. </p><ul class="inline-task-list" data-inline-tasks-content-id="87228590"><li data-inline-task-id="16">Discuss daily variation issue here</li></ul><h2 id="CALSIMDSM2Integration-VersionControl">Version Control</h2><p>CALSIM and DSM2 have different versions, evolving at different rates for different needs. As a result is important to manage these versions and the mappings between them. <a class="unresolved" href="#">Draft_CALSIMII_DCU_Modification_081809</a></p><ul><li> What if CALSIM schematic changes?  Implication for the integration above?</li></ul><p><br/></p><h2 id="CALSIMDSM2Integration-Notes">Notes</h2><p>Martinez stage <span class="inline-comment-marker" data-ref="573d12d0-9ebe-4b95-876a-bb1e70bc4f76">has been adjusted a little bit on 24DEC1967 to overcome a dry-up breakdown at channel 201</span>. The correction reside in a timeseries ${DSM2}\timeseries\Planning_Tide_82years.dss. Planning study users should add it to replace the regular timeseries.</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/87228590/87228589.png">bat_prep.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 16, 2023 11:04</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
